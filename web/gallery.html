<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å›¾ç‰‡åº“ - RIFS</title>
    <link rel="stylesheet" href="/static/style.css">
    <style>
         .stats{display:flex;gap:20px;margin-bottom:20px;flex-wrap:wrap}
          .stat{background:rgba(15,23,42,0.5);padding:12px 16px;border-radius:8px;border-left:3px solid #06b6d4}
          .stat-label{color:#94a3b8;font-size:0.75rem;text-transform:uppercase}
          .stat-value{color:#06b6d4;font-size:1.2rem;font-weight:600}
          .masonry{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:20px;animation:fadeIn 0.3s ease-in;width:100%;min-height:200px}
          @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
          @media (max-width:1200px){.masonry{grid-template-columns:repeat(3,1fr)}}
          @media (max-width:768px){.masonry{grid-template-columns:repeat(2,1fr)}}
          @media (max-width:480px){.masonry{grid-template-columns:repeat(1,1fr)}}
          .image-item{background:rgba(15,23,42,0.5);border-radius:8px;overflow:hidden;transition:transform 0.2s,box-shadow 0.2s;cursor:pointer;display:flex;flex-direction:column;width:100%}
          .image-item:hover{transform:translateY(-4px);box-shadow:0 8px 16px rgba(6,182,212,0.2)}
          .image-item img{width:100%;height:200px;object-fit:cover;display:block;background:rgba(6,182,212,0.1)}
          .image-item.loading-skeleton{background:linear-gradient(90deg,rgba(6,182,212,0.1),rgba(6,182,212,0.05),rgba(6,182,212,0.1));background-size:200% 100%;animation:shimmer 1.5s infinite}
          @keyframes shimmer{0%{background-position:200% 0}100%{background-position:-200% 0}}
          .image-info{padding:8px}
          .image-name{color:#cbd5e1;font-size:0.75rem;margin-bottom:4px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
          .image-meta{color:#94a3b8;font-size:0.7rem}
          body.select-mode .image-checkbox{display:block}
          body.select-mode .image-item{cursor:default}
          body.select-mode .image-item:hover{transform:none;box-shadow:none}
          body.select-mode .image-actions{opacity:1}

         .image-checkbox{position:absolute;top:8px;left:8px;width:20px;height:20px;cursor:pointer;z-index:10;display:none}
         .image-item.selected{border:2px solid #06b6d4;box-shadow:0 0 12px rgba(6,182,212,0.5)}
         .image-item{position:relative}
         .image-actions{position:absolute;top:8px;right:8px;display:flex;gap:4px;opacity:0;transition:opacity 0.2s;z-index:10}
         .image-item:hover .image-actions{opacity:1}
         .action-btn{background:rgba(15,23,42,0.8);border:1px solid rgba(6,182,212,0.5);color:#06b6d4;padding:4px 8px;border-radius:4px;cursor:pointer;font-size:0.7rem;transition:all 0.2s}
         .action-btn:hover{background:rgba(6,182,212,0.2);border-color:#06b6d4}
         .action-btn.delete{color:#ef4444;border-color:rgba(239,68,68,0.5)}
         .action-btn.delete:hover{background:rgba(239,68,68,0.2);border-color:#ef4444}
         .batch-actions{display:none;margin-bottom:16px;padding:12px;background:rgba(15,23,42,0.5);border-radius:8px;gap:8px;align-items:center;flex-wrap:wrap}
         .batch-actions.active{display:flex}
         .batch-actions .btn{padding:8px 16px;font-size:0.85rem;margin:0}
         .batch-actions .select-info{color:#94a3b8;font-size:0.85rem;margin-right:auto}
         .pagination{display:flex;justify-content:center;align-items:center;gap:8px;margin:20px 0;flex-wrap:wrap}
         .pagination-info{color:#94a3b8;font-size:0.85rem;margin:0 10px}
         .load-more{text-align:center;margin:20px 0}
         .load-more-btn{padding:12px 32px;background:linear-gradient(135deg,#06b6d4,#3b82f6);border:none;border-radius:6px;color:#fff;cursor:pointer;font-size:1rem;transition:all 0.2s}
         .load-more-btn:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(6,182,212,0.4)}
         .load-more-btn:disabled{opacity:0.5;cursor:not-allowed;transform:none}
         .no-images{text-align:center;color:#94a3b8;padding:40px}
         .loading{text-align:center;color:#06b6d4;padding:20px}
         .loading-spinner{display:inline-block;width:20px;height:20px;border:2px solid rgba(6,182,212,0.2);border-top:2px solid #06b6d4;border-radius:50%;animation:spin 0.8s linear infinite}
         @keyframes spin{to{transform:rotate(360deg)}}
         .modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:1000;justify-content:center;align-items:center}
         .modal img{max-width:90%;max-height:90%;border-radius:8px}
         .modal-close{position:absolute;top:20px;right:40px;color:#fff;font-size:2rem;cursor:pointer}
         .confirm-dialog{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:linear-gradient(135deg,#0f172a,#1e293b);border:1px solid rgba(6,182,212,0.3);border-radius:12px;padding:24px;max-width:400px;width:90%;z-index:1001;box-shadow:0 8px 32px rgba(0,0,0,0.5)}
         .confirm-dialog.show{display:block;animation:slideIn 0.2s ease-out}
         @keyframes slideIn{from{opacity:0;transform:translate(-50%,-60%)}to{opacity:1;transform:translate(-50%,-50%)}}
         .confirm-dialog h3{color:#06b6d4;margin:0 0 12px 0;font-size:1.2rem}
         .confirm-dialog p{color:#cbd5e1;margin:0 0 20px 0;line-height:1.5}
         .confirm-dialog .buttons{display:flex;gap:12px;justify-content:flex-end}
         .confirm-dialog .btn{padding:10px 20px;border:none;border-radius:6px;cursor:pointer;font-size:0.9rem;transition:all 0.2s}
         .confirm-dialog .btn-cancel{background:rgba(148,163,184,0.2);color:#cbd5e1}
         .confirm-dialog .btn-cancel:hover{background:rgba(148,163,184,0.3)}
         .confirm-dialog .btn-confirm{background:#ef4444;color:#fff}
         .confirm-dialog .btn-confirm:hover{background:#dc2626}
         .toast{position:fixed;top:20px;right:20px;background:linear-gradient(135deg,#0f172a,#1e293b);border:1px solid rgba(6,182,212,0.3);border-radius:8px;padding:16px 20px;color:#fff;z-index:1002;display:none;box-shadow:0 4px 16px rgba(0,0,0,0.3);animation:slideInRight 0.3s ease-out}
         .toast.show{display:block}
         .toast.success{border-color:rgba(34,197,94,0.5)}
         .toast.error{border-color:rgba(239,68,68,0.5)}
         .toast.info{border-color:rgba(59,130,246,0.5)}
         @keyframes slideInRight{from{opacity:0;transform:translateX(100%)}to{opacity:1;transform:translateX(0)}}
     </style>
</head>
<body>
    <div id="auth-info" class="auth-info" style="display: none;">
        <span>å·²ç™»å½•</span>
        <button class="logout-btn" onclick="logout()">é€€å‡º</button>
    </div>
    <div class="container">
        <header class="header">
            <h1>å›¾ç‰‡åº“</h1>
            <p>æµè§ˆæ‰€æœ‰ä¸Šä¼ çš„å›¾ç‰‡</p>
        </header>

        <section class="card">
            <div class="card-header">ç»Ÿè®¡ä¿¡æ¯</div>
            <div class="card-content">
                <div class="stats">
                    <div class="stat">
                        <div class="stat-label">æ€»æ•°</div>
                        <div class="stat-value" id="total-count">-</div>
                    </div>
                    <div class="stat">
                        <div class="stat-label">å½“å‰æ˜¾ç¤º</div>
                        <div class="stat-value" id="current-count">0</div>
                    </div>
                    <div class="stat">
                        <div class="stat-label">å¹³å‡å¤§å°</div>
                        <div class="stat-value" id="avg-size">-</div>
                    </div>
                </div>
            </div>
        </section>

        <section class="card">
            <div class="card-header">
                å›¾ç‰‡åˆ—è¡¨
                <div style="float:right;display:flex;gap:8px;align-items:center">
                    <button class="btn" onclick="refreshImages()" style="padding:8px 16px;font-size:0.8rem">åˆ·æ–°</button>
                    <button class="btn" onclick="toggleSelectMode()" id="select-mode-btn" style="padding:8px 16px;font-size:0.8rem">æ‰¹é‡é€‰æ‹©</button>
                </div>
            </div>
            <div class="card-content">
                <div id="batch-actions" class="batch-actions">
                    <div class="select-info" id="select-info">å·²é€‰æ‹© 0 é¡¹</div>
                    <button class="btn" onclick="selectAllVisible()">å…¨é€‰å½“å‰é¡µ</button>
                    <button class="btn" onclick="clearSelection()">æ¸…é™¤é€‰æ‹©</button>
                    <button class="btn" style="background:#ef4444;border-color:#ef4444" onclick="confirmDeleteSelected()">åˆ é™¤é€‰ä¸­</button>
                </div>
                <div id="loading" class="loading">
                    <div class="loading-spinner"></div>
                    <p>åŠ è½½ä¸­...</p>
                </div>
                <div id="masonry" class="masonry" style="display:none"></div>
                <div id="pagination" class="pagination" style="display:none">
                    <span class="pagination-info">
                        æ˜¾ç¤º <span id="display-start">0</span>-<span id="display-end">0</span> / <span id="total-display">0</span>
                    </span>
                    <button class="load-more-btn" id="load-more-btn" onclick="loadMoreImages()">åŠ è½½æ›´å¤š</button>
                </div>
                <div id="no-images" class="no-images" style="display:none">
                    <div>ğŸ“·</div>
                    <p>æš‚æ— å›¾ç‰‡</p>
                </div>
            </div>
        </section>

        <footer class="footer">
            <p><a href="/">è¿”å›é¦–é¡µ</a> | <a href="/cache/management">ç¼“å­˜ç®¡ç†</a></p>
        </footer>
    </div>

    <div id="image-modal" class="modal">
        <span class="modal-close" onclick="closeModal()">&times;</span>
        <img id="modal-image" src="" alt="">
    </div>

    <div id="confirm-dialog" class="confirm-dialog">
        <h3 id="confirm-title">ç¡®è®¤åˆ é™¤</h3>
        <p id="confirm-message">ç¡®å®šè¦åˆ é™¤é€‰ä¸­çš„å›¾ç‰‡å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚</p>
        <div class="buttons">
            <button class="btn btn-cancel" onclick="closeConfirmDialog()">å–æ¶ˆ</button>
            <button class="btn btn-confirm" onclick="confirmDialogAction()">åˆ é™¤</button>
        </div>
    </div>

    <div id="toast" class="toast"></div>

    <script src="/static/gallery.js"></script>
</body>
</html>
